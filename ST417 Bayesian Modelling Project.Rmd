---
title: "ST417 Bayesian Modelling Project"
author: "Fionn McGlacken 19388186"
date: "`r Sys.Date()`"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
install.packages(dplyr)
install.stringr
library(stringr)
library(dplyr)
```

```{r}
data <- read.csv('data.csv')
# est = estimated
new_names = c('timestamp', 'est_time', 'est_distance', 'est_cost', 'est_transport', 'year_group', 'time', 'start_time', 'distance', 'cost', 'transport', 'origin')
colnames(data) <- new_names
```

```{r}
# glimpse(data)
```

```{r}
data <- data %>% mutate(timestamp = as.Date(timestamp))
data <- data %>% mutate(day = weekdays(timestamp))
```

```{r}
data$est_time
```

```{r}
# convert hours to minutes
# get mean of range
hours <- c('hours', 'hrs')
cond1 <- grepl(paste(hours, collapse="|"), data$est_time)
new_hours = str_remove(data$est_time[cond], hours)
temp_table = read.table(text=new_hours, sep='-', header=FALSE) * 60
means = rowMeans(temp_table, na.rm=TRUE)
data$est_time[cond1] <- means

# get mean of range
cond3 <- grepl('^(\\d+)-(\\d+)$', data$est_time)
data$est_time[cond3] <- rowMeans(read.table(text = data$est_time[cond3],
     sep = '-', header = FALSE), na.rm = TRUE)
```

```{r}
data$est_time
```
